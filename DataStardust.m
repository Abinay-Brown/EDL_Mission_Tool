SD_Alt_Time = [0.7461249638971736, 123.74130421399329
3.0821898413741096, 119.98499399759905
5.4182547188510455, 115.96415489272633
7.7543195963279885, 111.89041001015792
10.090384473804917, 108.23991134915505
12.42644935128186, 104.5365069104565
14.76251422875879, 100.83310247175794
17.098579106235732, 97.28841536614647
19.43464398371266, 93.95535137131776
21.770708861189604, 90.56938159879337
24.496117884912692, 86.65435404931205
27.61087105488194, 82.64674138886325
30.725624224851188, 78.5597700618709
33.840377394820436, 74.75055406778097
36.955130564789684, 71.17941407332165
40.45922788100509, 67.38606981254041
44.35266934346666, 63.48162341859822
48.63545495217437, 59.72531320220398
53.6969288533744, 56.02190876350541
59.53709104706674, 52.45076876904609
66.54528567949755, 49.21293517406964
74.72151275066683, 46.210291809031304
83.28708396808226, 43.641956782713095
91.85265518549771, 41.34776987718165
100.41822640291313, 39.22672915319974
108.98379762032856, 37.163403823067696
117.54936883774401, 35.14336503832304
126.11494005515944, 33.09446855665344
134.68051127257485, 31.060000923446324
143.24608248999033, 29.0976775325515
151.81165370740575, 27.193069535506524
160.37722492482118, 25.389463477698783
168.9427961422366, 23.787861298365513
177.50836735965203, 22.373834149044242
186.07393857706745, 21.104095484347596
194.63950979448293, 19.935358758888185
203.20508101189836, 18.882052821128468
211.77065222931378, 17.929748822605987
220.3362234467292, 17.064017914858255
228.9017946641447, 16.22714470403548
237.4673658815601, 15.462415735525013
246.03293709897554, 14.75540216086435
254.59850831639096, 14.048388586203714
263.1640795338064, 13.427948102317856
271.7296507512218, 12.778649921507082
280.2952219686373, 12.215924831471057
288.8607931860527, 11.696486286822449
297.42636440346814, 11.119332348323951
305.99193562088357, 10.614322652137787
314.557506838299, 10.13817065287654
323.1230780557144, 9.662018653615291
331.6886492731299, 9.200295502816516
340.2542204905453, 8.709714655092824
348.81979170796075, 8.276849201218965
357.38536292537617, 7.887270292732495
365.9509341427916, 7.42554714193372
374.516505360207, 7.007110536522305
383.0820765776225, 6.631960476498307
391.6476477950379, 6.227952719549364
400.21321901245335, 5.838373811062922
408.7787902298688, 5.448794902576424
417.3443614472842, 5.088073691014898
425.9099326646996, 4.756210176378261
434.4755038821151, 4.381060116354234
443.04107509953053, 4.049196601717625
451.60664631694596, 3.702904238618544
460.17221753436144, 3.3854695724443786
468.7377887517768, 3.039177209345297
477.3033599691923, 2.7073136947086596
485.86893118660765, 2.418736725459439
494.43450240402314, 2.0724443623603577
503.0000736214385, 1.7838673931111089
511.565644838854, 1.4664327269369437
520.1312160562694, 1.1778557576877233
528.6967872736848, 0.8892787884384745
537.2623584911003, 0.5862729707267818
545.4385855622695, 0.2962531166312772];

SD_HR_Time = [21.153846153846153, 0.30674846625765895
25, 0.30674846625765895
29.03846153846154, 0.30674846625765895
38.26923076923077, 0.30674846625765895
48.07692307692307, 0.30674846625765895
58.84615384615384, 3.374233128834362
68.07692307692307, 5.674846625766861
73.84615384615385, 11.809815950920267
77.3076923076923, 18.71165644171782
79.03846153846153, 23.31288343558282
81.15384615384615, 30.98159509202452
83.46153846153847, 41.717791411042924
85.76923076923077, 53.98773006134968
87.5, 67.79141104294479
89.8076923076923, 88.49693251533739
92.88461538461539, 116.87116564417175
94.99999999999999, 141.41104294478527
97.49999999999999, 172.08588957055213
99.61538461538461, 210.42944785276072
101.34615384615384, 239.57055214723923
103.46153846153847, 277.9141104294479
105.1923076923077, 302.4539877300613
106.53846153846153, 317.7914110429448
108.07692307692307, 334.66257668711654
108.84615384615384, 343.8650306748466
110.57692307692307, 355.36809815950915
112.11538461538461, 358.43558282208585
114.23076923076923, 352.3006134969325
115.1923076923077, 342.33128834355824
115.96153846153845, 330.8282208588957
116.73076923076923, 322.3926380368098
117.3076923076923, 312.4233128834355
118.26923076923076, 299.3865030674846
119.03846153846155, 285.5828220858896
120.38461538461539, 263.34355828220856
121.34615384615384, 244.17177914110428
122.11538461538461, 227.3006134969325
123.46153846153847, 205.06134969325151
124.23076923076923, 185.8895705521472
126.15384615384615, 159.04907975460122
127.49999999999999, 135.27607361963192
129.23076923076923, 106.90184049079755
131.15384615384613, 86.19631901840489
133.46153846153845, 69.32515337423314
135.76923076923077, 50.92024539877298
138.46153846153845, 36.34969325153378
142.88461538461536, 21.779141104294524
145.96153846153845, 14.87730061349697
149.61538461538464, 9.509202453987712
154.23076923076923, 4.907975460122714
159.61538461538464, 3.374233128834362
164.61538461538458, 2.607361963190158
169.61538461538458, 0.30674846625765895
174.4230769230769, 0.30674846625765895
178.46153846153845, 0.30674846625765895
183.65384615384613, 0.30674846625765895
189.80769230769226, 0.30674846625765895
];

SD_Vel_Time = [4.3198141591296775, 12.787413130411151
12.858541708708643, 12.787413130411151
21.397269258287608, 12.785979451305383
29.935996807866587, 12.689922951218911
36.53410445981396, 12.393151376324884
40.41534425507713, 12.002832239779478
43.13221211176135, 11.588857397988896
45.46095598891925, 11.163054703575728
47.40157588655083, 10.713596303917383
48.954071804656095, 10.311449314749389
50.50656772276136, 9.885646620336221
52.05906364086664, 9.436188220677874
53.611559558971905, 8.970959350856077
55.16405547707717, 8.537271421361183
56.716551395182435, 8.040501611212488
58.2690473132877, 7.551617036145514
59.821543231392965, 7.078502931241993
61.37403914949823, 6.629044531583647
62.926535067603496, 6.226897542415655
64.47903098570877, 5.816865318165936
66.03152690381404, 5.422603564079669
67.5840228219193, 5.051997515238577
69.52464271955088, 4.602539115580232
71.85338659670879, 4.1504523042279775
74.18213047386669, 3.7509337267538925
76.51087435102458, 3.377699266218892
79.2277422077088, 2.990008541367395
82.72085802344564, 2.564994370462399
86.60209781870883, 2.167578522343442
90.8714615934983, 1.8164227200372718
96.30519730686673, 1.4563303179718137
103.67955291786676, 1.1014947392941732
112.21828046744572, 0.8133252390347554
120.75700801702469, 0.6083091269098961
129.29573556660364, 0.4721096118619137
137.83446311618263, 0.37892046998697637
146.37319066576157, 0.314404910227406
154.91191821534056, 0.2685271788428203
163.45064576491956, 0.23411888030438277
171.9893733144985, 0.20831265640055463
180.5281008640775, 0.19540954444864056
189.06682841365642, 0.17103699965058006
197.60555596323542, 0.16530228322750773
206.14428351281435, 0.14092973842944723
214.68301106239335, 0.1394960593236796
223.22173861197228, 0.1394960593236796
231.76046616155128, 0.12515926826599788
240.29919371113021, 0.12372558916022847
248.8379212607092, 0.10795511899677734
257.37664881028815, 0.10795511899677734
265.91537635986714, 0.10795511899677734
274.4541039094461, 0.10795511899677734
282.99283145902507, 0.10795511899677734
291.53155900860406, 0.09935304436216974
300.070286558183, 0.09218464883332622
308.609014107762, 0.09218464883332622
317.14774165734093, 0.09218464883332622
325.6864692069199, 0.09218464883332622
334.22519675649886, 0.09075096972755858
342.76392430607785, 0.07641417866987688
351.3026518556568, 0.07641417866987688
359.8413794052358, 0.07641417866987688
368.3801069548147, 0.07641417866987688
376.9188345043937, 0.07641417866987688
385.4575620539727, 0.07641417866987688
393.99628960355165, 0.07641417866987688
402.53501715313064, 0.07641417866987688
411.0737447027096, 0.07641417866987688
419.61247225228857, 0.07641417866987688
428.1511998018675, 0.07641417866987688
436.6899273514465, 0.07641417866987688
445.22865490102544, 0.07641417866987688
453.76738245060443, 0.07641417866987688
462.30611000018337, 0.07641417866987688
470.84483754976236, 0.07641417866987688
479.38356509934135, 0.07641417866987688
487.92229264892035, 0.07641417866987688
496.4610201984992, 0.07641417866987688
504.9997477480782, 0.07641417866987688
513.5384752976572, 0.07641417866987688
522.0772028472362, 0.07641417866987688
530.6159303968151, 0.07641417866987688
539.1546579463941, 0.07641417866987688
546.1408895778678, 0.07641417866987688
];
dt = 0.5;
tspan = 0:dt:550;

alts = interp1(SD_Alt_Time(:, 1), SD_Alt_Time(:, 2)*1000, tspan, 'spline', 'extrap');
vels = interp1(SD_Vel_Time(:, 1), SD_Vel_Time(:, 2), tspan, 'spline', 'extrap');
acc = gradient(vels*1000, dt);

Stardust.t = tspan;
Stardust.h = alts/1000;
Stardust.V = vels;
Re = 6371e3;
g0 = 9.8066;
r = Re + alts;
g = g0 .* (Re./r).^2;
rho0 = 1.225;
H = 8.5;

V = vels*1000;

[Stardust.nmax, idx] = max(abs(acc ./ g));
Stardust.hnmax = Stardust.h(idx);
Stardust.Vnmax = Stardust.V(idx);
Stardust.qdotmax = max(abs(SD_HR_Time(:, 2)));
Stardust.qintmax = max(cumtrapz(SD_HR_Time(:, 1), SD_HR_Time(:, 2)));